"use strict";define(["Zepto","service","utils"],function(a,b,c){window.showDialog=function(b){var c=a("#"+b);c.css("display","block"),c.find("input[type=text]").select()},window.cancleDialog=function(b){a(b).parent().parent().parent().css("display","none")};var d=function(d,e){b.updateSomeInfo(d,function(){a(e).parent().parent().parent().css("display","none"),c.showToastMsg("已保存",null,null,function(){window.location.reload()})},function(a,b){c.showToastMsg(a,"warn")})};a("#userid").val();a("#btn-sign").tap(function(){d({sign:a("#sign-text").val()},this)}),a("#btn-sex").tap(function(){d({sex:a("select[name=sex-select] option:selected").val()},this)}),a("#btn-phone").tap(function(){d({phone:a("#phone-text").val()},this)}),a("#btn-bankAccount").tap(function(){d({bankAccount:a("#bankAccount-text").val()},this)}),a("#btn-bankName").tap(function(){d({bankName:a("#bankName-text").val()},this)}),a("#btn-bankUserName").tap(function(){d({bankUserName:a("#bankUserName-text").val()},this)});var e=function(b,c){var d=a(b).children("option");a.each(d,function(b,d){if(a(d).text().indexOf(c)>-1)return a(d).attr("selected","selected"),!1})};if(a("#icon-input").on("change",function(){var b=this.files?this.files:[];if(b.length&&window.FileReader&&/^image/.test(b[0].type)){var c=new FileReader;c.readAsDataURL(b[0]),c.onloadend=function(){a("#icon-preview").css("background-image","url("+this.result+")")}}}),a("#btn-icon").tap(function(){var b=a("#icon-input").get(0).files[0];console.log(b);var c=new FormData;c.append("imgFile",b),a.ajax({type:"post",url:"/uploadImage",data:c,contentType:!1,processData:!1,success:function(a){console.log("resp:"+a.data),d({headImg:a.data},this)},error:function(){return alert("Upload failed."),!1}})}),birthdayData&&""!=birthdayData){var f=a.trim(birthdayData).split("-");e(a("#yearSelect"),f[0]),e(a("#monthSelect"),f[1]),e(a("#daySelect"),f[2])}a("#btn-birthday").tap(function(){var b,c=a("#yearSelect option:selected").text(),e=a("#monthSelect option:selected").text(),f=a("#daySelect option:selected").text();b=null!=e&&null!=f?c+"-"+e+"-"+f:c,d({birthday:b},this)});var g={},h=a("#provinceSelect"),i=a("#citySelect"),j=a("#univSelect"),k="<option data-spec='true'>请选择</option>";h.html(k),i.html(k),j.html(k),h.on("change",function(){var b=a(this).children("option:selected").val();if("请选择"==b)return i.html(k),void j.html(k);var c="<option data-spec='true'>请选择</option>";a.each(g[b],function(a,b){c=c+"<option>"+b+"</option>"}),i.html(c),j.html(k)});var l=!0;i.on("change",function(){var c=a(this).children("option:selected").val();return"请选择"==c?void j.html(k):void b.getSchool4Univ({univ:c},function(b){var c="<option data-id='' data-spec='true'>请选择</option>";a.each(b,function(a,b){c=c+"<option data-id='"+b.id+"'>"+b.school+"</option>"}),j.html(c);var d=schoolModel.school;l&&""!=d&&e(j,d),l=!1})}),b.getUnivArray({},function(b){g=b;var c="<option data-spec='true'>请选择</option>";if(a.each(g,function(a,b){c=c+"<option>"+a+"</option>"}),h.html(c),schoolModel){var d=schoolModel.province,f=schoolModel.univ;schoolModel.school;e(h,d),h.trigger("change"),e(i,f),i.trigger("change")}}),a("#btn-school").tap(function(){var a=j.children("option:selected").attr("data-id");a&&""!=a&&d({schoolId:a},this)}),entryYearData&&""!=entryYearData&&e(a("#entrySelect"),entryYearData),a("#btn-entryYear").tap(function(){d({entryYear:a("select[name=entry-select] option:selected").text()},this)}),a("#btn-withdraw").tap(function(){cancleDialog(this)})});